# ConvLSTM Configuration: High Capacity Model (24GB+ GPU)
# This configuration trains a larger model for maximum accuracy
# Requires high-end GPU (RTX 3090, A5000, or better)

# Data Configuration
data:
  data_path: "data/regional_weather.nc"
  output_dir: "checkpoints/high_capacity"
  
  # Data splitting (temporal ordering preserved)
  train_ratio: 0.7
  val_ratio: 0.15
  # Remaining 0.15 for test set
  
  # Window configuration
  window_size: 6  # 3 days at 12-hour intervals
  target_offset: 1  # Predict 12 hours ahead

# Region Configuration
region:
  # Downstream region (target prediction area)
  downstream:
    lat_min: 25.0
    lat_max: 40.0
    lon_min: 110.0
    lon_max: 125.0
  
  # Upstream region (influencing area west of downstream)
  upstream:
    lat_min: 25.0
    lat_max: 40.0
    lon_min: 70.0
    lon_max: 110.0
  
  include_upstream: true  # Enable upstream region

# Model Architecture
model:
  input_channels: 56  # 5 vars Ã— 11 levels + 1 precip
  hidden_channels: [64, 128, 256]  # Deeper architecture with 3 levels
  kernel_size: 3
  output_channels: 1  # Precipitation only

# Training Configuration
training:
  # Optimization
  learning_rate: 0.001
  weight_decay: 0.00001
  batch_size: 16  # Larger batch size for better gradient estimates
  num_epochs: 150  # More epochs for larger model
  
  # Gradient management
  gradient_clip_norm: 1.0
  gradient_accumulation_steps: 1
  
  # Memory optimization
  use_amp: true  # Mixed precision still beneficial
  num_workers: 4  # More workers for faster data loading
  pin_memory: true
  
  # Scheduler
  scheduler_type: "cosine"  # cosine, step, or none
  scheduler_patience: 5  # For ReduceLROnPlateau
  scheduler_factor: 0.5
  warmup_epochs: 5  # Warmup for large batch training

# Loss Function Configuration
loss:
  high_precip_threshold: 10.0  # mm
  high_precip_weight: 3.0  # Weight multiplier for high precipitation
  latitude_weighting: true  # Apply cos(latitude) weighting

# Checkpointing and Validation
checkpointing:
  checkpoint_frequency: 500  # Save more frequently
  validation_frequency: 250  # Validate more frequently
  early_stopping_patience: 15  # More patience for larger model
  save_best_only: false  # Save periodic checkpoints

# Logging
logging:
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_to_file: true
  log_to_console: true

# Device Configuration
device:
  device: "auto"  # auto, cuda, cpu
  cuda_device: 0  # GPU index if multiple GPUs available

# Expected Performance
# - Peak memory: ~15-20 GB
# - Training time: ~60-90 minutes per epoch
# - Total training: ~150-225 hours for 150 epochs
# - Higher accuracy than standard configuration
#
# Note: This configuration is for research purposes where maximum
# accuracy is desired and computational resources are available
